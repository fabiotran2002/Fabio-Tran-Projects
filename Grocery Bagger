import java.io.BufferedReader ;
import java.io.FileReader ;
import java.io.IOException ;
import java.util.ArrayList ;
import java.util.Scanner ;

/**
 * An application that fills grocery bags (instances of a Bag) given a variety of
 * grocery items.
 *
 * @author Fabio Tran
 * @version 1.0.0 initial version
 */
public class GroceryBagger
    {

    /**
     * Runs application
     *
     * @param args
     *     unused
     * @throws IOException
     *     throws if file is not found
     */
    public static void main( String[] args ) throws IOException
        {
        Scanner scanner = new Scanner( new BufferedReader( new FileReader( "./data/groceries.txt" ) ) ) ;   // Reads
                                                                                                            // groceries.txt
                                                                                                            // file
        ArrayList<GroceryBag> bags = new ArrayList<>() ;   // Used to store several
                                                           // instances of grocery
                                                           // bag
        bags.add( new GroceryBag() ) ; // Initialize array-list with one bag

        System.out.println( "Bagging Items: \n" ) ;

        // Iterates through each line of the text file to create and add each item to
        // a grocery bag.
        while ( scanner.hasNext() )
            {
            // Each line's content is split into an array of strings
            String[] line = scanner.nextLine().split( "\t" ) ;

            // Creates an grocery item using item description from current line of
            // the text file.
            // Index 0 refers to name, index 1 refers to size, index 2 refers to
            // weight, index 5 refers to breakable/unbreakable (not all
            // attributes have been implemented to sort items in this version).
            GroceryItem item = new GroceryItem( line[ 0 ],
                                                line[ 1 ],
                                                line[ 2 ],
                                                line[ 5 ] ) ;

            // Uses GroceryItemSize enumeration to associate size value to each item
            GroceryItemSize itemSize = GroceryItemSize.interpretDescription( item.getSize() ) ;
            int size = itemSize.sizeValue ;

            item.setSizeValue( size ) ;   // Set the size value of given item

            boolean added = false ; // Used to continue loop until item is added
            // Loop will go through all current grocery bags, item will be added if
            // there is space and if not a new bag will be created
            while ( added == false )
                {
                for ( int i = 0 ; i < bags.size() ; i++ )
                    {
                    if ( bags.get( i ).add( item ) && !added )
                        {
                        int bagNumber = i + 1 ;
                        System.out.println( "Put" + " " + item.toString() + " " +
                                            "in bag " + bagNumber ) ;
                        added = true ;
                        break ; // Exists loop once item has been added
                        } // end if
                    } // end for

                if ( added == false )
                    {
                    bags.add( new GroceryBag() ) ; // Adds new bag to store item
                    } // end if

                } // end while

            }   // end while

        // Printing to console the contents of each bag in the ArrayList
        for ( int i = 0 ; i < bags.size() ; i++ )
            {
            int bagNumber = i + 1 ;
            System.out.println( bagNumber + ":" + bags.get( i ).toString() ) ;
            }   // end for

        }   // end main()

    }
